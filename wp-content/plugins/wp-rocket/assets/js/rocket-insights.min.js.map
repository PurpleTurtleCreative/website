{"version":3,"names":[],"mappings":"","sources":["rocket-insights.min.js"],"sourcesContent":["!function i(a,n,s){function o(e,t){if(!n[e]){if(!a[e]){var r=\"function\"==typeof require&&require;if(!t&&r)return r(e,!0);if(d)return d(e,!0);throw(t=new Error(\"Cannot find module '\"+e+\"'\")).code=\"MODULE_NOT_FOUND\",t}r=n[e]={exports:{}},a[e][0].call(r.exports,function(t){return o(a[e][1][t]||t)},r,r.exports,i,a,n,s)}return n[e].exports}for(var d=\"function\"==typeof require&&require,t=0;t<s.length;t++)o(s[t]);return o}({1:[function(t,e,r){e.exports=(()=>{let i=5e3,a={};function t(){n(),s(),jQuery(\".wpr-ri-loading\").each(function(){var t=jQuery(this).closest(\".wpr-ri-column\"),e=t.data(\"rocket-insights-id\"),r=t.data(\"url\");e&&!a[e]&&o(e,0,t)})}function n(){jQuery(document).on(\"click\",\".wpr-ri-test-page\",function(t){t.preventDefault();var a,n,t=jQuery(this),e=t.data(\"url\"),r=t.closest(\".wpr-ri-column\");\"1\"===r.attr(\"data-can-add-pages\")?(a=e,n=r,t.prop(\"disabled\",!0),p(n,null),window.wp.apiFetch({path:\"/wp-rocket/v1/rocket-insights/pages/\",method:\"POST\",data:{page_url:a}}).then(t=>{var e=!0===t?.success,r=t?.id??t?.data?.id??null,i=t?.can_add_pages??t?.data?.can_add_pages;t?.message??t?.data?.message;e&&r?(n.attr(\"data-rocket-insights-id\",r),o(r,0,n),!1!==i&&0!==t?.data?.remaining_urls||jQuery(\".wpr-ri-test-page\").each(function(){jQuery(this).closest(\".wpr-ri-column\").attr(\"data-can-add-pages\",\"0\")})):u(n,a)}).catch(t=>{console.error(t),u(n,a)})):d(r,t)})}function s(){jQuery(document).on(\"click\",\".wpr-ri-retest:not(.wpr-ri-action--disabled), .wpr-ri-retest-link\",function(t){t.preventDefault();var e,r,i,t=jQuery(this),a=t.data(\"url\"),n=t.closest(\".wpr-ri-column\"),s=n.data(\"rocket-insights-id\");s&&(\"1\"===n.attr(\"data-has-credit\")?(r=a,p(i=n,e=s),window.wp.apiFetch({path:\"/wp-rocket/v1/rocket-insights/pages/\"+e,method:\"PATCH\"}).then(t=>{t.success?o(e,0,i):u(i,r)}).catch(t=>{console.error(t),u(i,r)})):d(n,t))})}function o(t,e,r){a[t]&&clearInterval(a[t]),a[t]=setInterval(function(){c(t,0,r)},i),c(t,0,r)}function d(t,e){var r=t.find(\".wpr-ri-limit-html\").html()||window.rocket_insights_i18n?.limit_reached||\"\";t.find(\".wpr-ri-message\").html(r).show(),e&&e.prop&&(e.prop(\"disabled\",!0),setTimeout(function(){e.prop(\"disabled\",!1)},3e3))}function c(r,t,i){window.wp.apiFetch({path:window.wp.url.addQueryArgs(\"/wp-rocket/v1/rocket-insights/pages/progress\",{ids:[r]})}).then(t=>{var e;t.success&&Array.isArray(t.results)&&(\"completed\"!==(t=t.results[0]).status&&\"failed\"!==t.status||(clearInterval(a[r]),delete a[r],e=(t=i).data(\"url\"),u(t,e)))})}function p(t,e){e&&t.attr(\"data-rocket-insights-id\",e);var e=jQuery(\"<div>\").addClass(\"wpr-ri-loading wpr-btn-with-tool-tip\"),r=jQuery(\"<img>\").addClass(\"wpr-loading-img\").attr({src:window.rocket_insights_i18n?.loading_img||\"\",alt:\"Loading...\"}),i=jQuery(\"<div>\").addClass(\"wpr-ri-message\").css(\"display\",\"none\");e.append(r),e.append(`<div class=\"wpr-tooltip\"><div class=\"wpr-tooltip-content\">${window.rocket_insights_i18n?.estimated_time_text||\"Analyzing your page (~1 min).\"}</div></div>`),t.empty().append(e).append(i)}function u(e,t){var r=e.data(\"post-id\");window.wp.apiFetch({path:window.wp.url.addQueryArgs(\"/wp-rocket/v1/rocket-insights/pages\",{url:t,post_id:r})}).then(t=>{t.success&&t.html&&(e.replaceWith(t.html),n(),s())}).catch(t=>{console.error(\"Failed to reload column:\",t)})}return\"loading\"===document.readyState?document.addEventListener(\"DOMContentLoaded\",t):t(),{init:t}})()},{}]},{},[1]);"],"file":"rocket-insights.min.js"}